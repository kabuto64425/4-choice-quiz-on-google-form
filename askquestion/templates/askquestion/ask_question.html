{% extends "_base.html" %}
{% block content %}
    {% load static %}
    {% load crispy_forms_tags %}
    <div id="app" class="container">
        <div class="row">
            <div class="col-12">
                <div class="float-right mt-1">
                    <a class="btn btn-outline-dark" href="{% url 'deck_list' %}">戻る</a>
                </div>
            </div>
        </div>
        <div style="height:1400px">
        <div class="row mt-3">
            <div v-for="(panel, index) in panels" class="col-1" @click="open(index)">
                <div class="embed-responsive embed-responsive-1by1 border d-flex align-items-center justify-content-center display-4" :class="[panel.isOpen? 'alert alert-light' : 'alert alert-dark']" style="cursor: pointer;">
                    <span class="text-dark" v-if="panel.isOpen">[[panel.chara]]</span>
                    <span v-else>[[index + 1]]</span>
                </div>
            </div>
        </div>
        </div>
        <div class="row">
            <div class="col text-center">
                <span style="background-color: black; color: black;">{{ questioncard.correct_answer }}</span>
            </div>
        </div>
        <div class="row justify-content-around">
            <div class="col-1"><a {% if prev_url != None %} href="{{ prev_url }}" {% else %} href="#" style="visibility: hidden;" {% endif %}><img style="height: 48px" src="{% static "icons/caret-left-square.svg" %}"></img></a></div>
            <div class="col-1"><a {% if next_url != None %} href="{{ next_url }}" {% else %} href="#" style="visibility: hidden;" {% endif %}><img style="height: 48px" src="{% static "icons/caret-right-square.svg" %}"></img></a></div>
        </div>
        {% for url in urls %}
        {% if forloop.counter0|divisibleby:10 %}
        <div class="row mt-3 justify-content-center">
            <div class="col-8 d-flex">
        {% endif %}
                <div class="p-1" style="width: 10%;"><a class="btn btn-outline-dark btn-block" href="{{url}}">{{forloop.counter}}</a></div>
        {% if forloop.counter|divisibleby:10 %}
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
    <script>
        const questionText = "{{ questioncard.question_text }}";
        const splitedQuestionTextFromServer = questionText.split("");

        const app = Vue.createApp({
            data() {
                return {
                    panels : splitedQuestionTextFromServer.map((c)=>{
                        return {
                            chara: c,
                            isOpen: false
                        }
                    }),
                }
            },
            methods: {
                open: function(index) {
                    this.panels[index].isOpen = true;
                }
            },
            delimiters: ['[[', ']]']
        }).mount("#app");
    </script>
{% endblock %}